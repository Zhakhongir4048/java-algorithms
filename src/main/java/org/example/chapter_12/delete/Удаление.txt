Под удалением подразумевается удаление с наибольшим ключом.
Этот узел всегда является корневым, поэтому его удаление выполняется просто.
Корень всегда хранится в ячейке 0 базового массива:
maxNode = heapArray[0];

Проблема в том, что после удаления корня дерево перестает быть полным; в нем появляется пустая ячейка.
«Дыру» необходимо заполнить.

Все элементы массива можно было бы сдвинуть на одну ячейку, но существует другое, более быстрое решение.
Последовательность действий при удалении наибольшего узла выглядит так:
1. Удалить корневой узел.
2. Переместить последний узел на место корневого.
3. Смещать его вниз до тех пор, пока он не окажется ниже большего и выше меньшего узла.

Последним узлом является крайний правый узел самого нижнего занятого уровня дерева.
Он соответствует последней заполненной ячейке массива. (На рис. 12.2 это узел с индексом 12 и значением 5.)
Копирование этого узла в корень выполняется тривиально:
heapArray[0] = heapArray[N-1];
N--;

Удаление корня приводит к уменьшению размера массива на 1.

В ходе смещения узел последовательно меняется местами с узлом, находящимся перед ним;
после каждой перестановки алгоритм проверяет, оказался ли узел в правильной позиции.

На шаге 3 новый корневой узел слишком мал для своей позиции, поэтому он смещается вниз на свое законное место.
Шаг 2 восстанавливает полноту пирамиды (отсутствие пустых ячеек), а шаг 3 восстанавливает условие пирамиды
(каждый узел больше своих потомков). Процесс удаления показан на рис. 12.3.

На рис. 12.3, а последний узел (30) копируется на место корневого. На рис. 12.3, б, в, г
последний узел смещается до своей позиции, которая находится на последнем уровне.
(Так бывает не всегда; процесс смещения может остановиться и на одном из промежуточных уровней.)
На рис. 12.3, д узел занимает правильную позицию.

В каждой промежуточной позиции алгоритм смещения проверяет, какой из потомков больше,
и меняет местами целевой узел с большим потомком.
Если бы целевой узел поменялся местами с меньшим потомком, то этот потомок стал бы
родителем большего потомка, а это было бы нарушением условия пирамиды.
Правильные и неправильные перестановки изображены на рис. 12.4.
